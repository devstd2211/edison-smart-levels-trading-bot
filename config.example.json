{
  "version": 2,
  "thresholds": {
    "defaults": {
      "confidence": {
        "min": 0.60,
        "clampMin": 0.30,
        "clampMax": 1.0
      },
      "rsi": {
        "oversold": 30,
        "overbought": 70,
        "extreme": { "low": 20, "high": 80 },
        "neutralZone": { "min": 45, "max": 55 }
      },
      "stopLoss": {
        "percent": 2.5,
        "atrMultiplier": 1.5,
        "minDistancePercent": 1.5
      },
      "distance": {
        "maxToLevel": 1.0,
        "minFloor": 0.3
      },
      "touches": {
        "min": 3,
        "strong": 5
      }
    },
    "regimes": {
      "LOW": {
        "confidence": { "min": 0.65 },
        "distance": { "maxToLevel": 0.3, "clusterThresholdPercent": 0.15 },
        "touches": { "min": 4 }
      },
      "MEDIUM": {
        "confidence": { "min": 0.55 },
        "distance": { "maxToLevel": 0.6, "clusterThresholdPercent": 0.25 },
        "touches": { "min": 3 }
      },
      "HIGH": {
        "confidence": { "min": 0.50 },
        "distance": { "maxToLevel": 1.2, "clusterThresholdPercent": 0.4 },
        "touches": { "min": 2 }
      }
    }
  },
  "boosts": {
    "liquiditySweep": 0.15,
    "divergence": 0.10,
    "choch": 0.10,
    "bos": 0.05,
    "trendAlignment": 0.15,
    "htfConfirmation": 0.15,
    "hvnMatch": 0.20,
    "orderbookWall": 0.15
  },
  "exchange": {
    "name": "bybit",
    "symbol": "XRPUSDT",
    "timeframe": "5",
    "apiKey": "",
    "apiSecret": "",
    "testnet": false,
    "demo": true
  },
  "timeframes": {
    "entry": {
      "interval": "1",
      "candleLimit": 1000,
      "enabled": true
    },
    "primary": {
      "interval": "5",
      "candleLimit": 500,
      "enabled": true
    },
    "trend1": {
      "interval": "15",
      "candleLimit": 500,
      "enabled": true
    },
    "trend2": {
      "interval": "30",
      "candleLimit": 250,
      "enabled": true
    },
    "context": {
      "interval": "60",
      "candleLimit": 100,
      "enabled": true
    }
  },
  "trading": {
    "leverage": 10,
    "riskPercent": 1,
    "maxPositions": 1,
    "tradingCycleIntervalMs": 10000,
    "orderType": "MARKET",
    "tradingFeeRate": 0.0002,
    "favorableMovementThresholdPercent": 0.1
  },
  "riskManagement": {
    "positionSizeUsdt": 10,
    "stopLossPercent": 1.5,
    "minStopLossPercent": 1.0,
    "breakevenOffsetPercent": 0.4,
    "trailingStopEnabled": false,
    "trailingStopPercent": 0.6,
    "trailingStopActivationLevel": 2,
    "takeProfits": [
      { "level": 1, "percent": 1.0, "sizePercent": 50 },
      { "level": 2, "percent": 2.0, "sizePercent": 50 }
    ],
    "timeBasedExitEnabled": false
  },
  "entryConfig": {
    "priceAction": {
      "enabled": true
    },
    "divergenceDetector": {
      "minStrength": 0.3,
      "priceDiffPercent": 0.2
    },
    "rsiPeriod": 14,
    "rsiOversold": 30,
    "rsiOverbought": 70,
    "fastEmaPeriod": 9,
    "slowEmaPeriod": 21,
    "zigzagDepth": 2
  },
  "strategyConfidence": {
    "priceAction": {
      "baseConfidence": 0.75,
      "conflictPenalty": 0.25
    }
  },
  "analyzerThresholds": {
    "liquidity": {
      "priceTolerancePercent": 0.3,
      "minTouchesForZone": 2,
      "fakeoutReversalPercent": 0.3,
      "oldTouchesWeight": 0.3
    },
    "divergence": {
      "minStrength": 0.3,
      "priceDiffThreshold": 0.2,
      "rsiDiffThreshold": 2
    },
    "flatMarket": {
      "maxRangeScore": 15,
      "maxSlopeScore": 15,
      "maxVolumeScore": 10
    },
    "btcCorrelation": {
      "strict": 0.7,
      "moderate": 0.5,
      "weak": 0.15
    }
  },
  "analyzer": {
    "weight": 0.15,
    "priority": 5,
    "minConfidence": 25,
    "maxConfidence": 85
  },
  "analyzerConstants": {
    "rsi": {
      "maxConfidence": 25
    },
    "ema": {
      "baseConfidence": 0.5,
      "strengthConfidenceMultiplier": 0.2
    }
  },
  "analyzerStrategic": {
    "_comment": "FIX #1-9: Strategic configuration for new analyzers and validators",
    "rsiAnalyzer": {
      "_comment": "FIX #1: Dynamic SHORT threshold with ATR adaptation",
      "enabled": true,
      "dynamicShortThresholdMode": "enabled",
      "dynamicShortThreshold": 50,
      "atrBasedAdaptation": true,
      "dynamicMultiplier": 2,
      "risingKnifePenalty": 0.6,
      "bounceBonus": 1.1,
      "minConfidenceAfterFallingKnife": 30,
      "logValidations": true
    },
    "chochBosDetector": {
      "_comment": "FIX #2: Full Break of Structure / Change of Character detection",
      "enabled": true,
      "baseConfidence": 75,
      "bosDetectionStrength": 0.8,
      "chochDetectionStrength": 0.85,
      "logAllDetections": true
    },
    "footprintAnalyzer": {
      "_comment": "FIX #3: Resistance rejection mode for SHORT",
      "enabled": true,
      "baseConfidence": 60,
      "maxConfidence": 85,
      "minClosePositionPercent": 70,
      "minBodyToRangeRatio": 0.6,
      "closePositionMultiplier": 0.15,
      "resistanceRejectionMode": "enabled",
      "resistanceRejectionConfidence": 70,
      "requireRejectWickPercent": 95,
      "blockLongInDowntrend": true,
      "rsiDowntrendThreshold": 55,
      "logDecisions": true
    },
    "hiddenDivergence": {
      "_comment": "FIX #4: Hidden divergence detection (Price HH but RSI LH)",
      "enabled": true,
      "hiddenBearishConfidence": 65,
      "hiddenBullishConfidence": 65,
      "logDetections": true
    },
    "wickAnalyzer": {
      "_comment": "FIX #5: Adaptive wick age handling",
      "enabled": true,
      "baseConfidence": 50,
      "maxConfidence": 80,
      "rejectionThresholdPercent": 40,
      "adaptiveAging": "enabled",
      "currentCandlePercent": 100,
      "previousCandlePercent": 70,
      "twoThreeCandlesPercent": 30,
      "logWickAge": true
    },
    "trendConflictDetector": {
      "_comment": "FIX #6: Detects conflicting signals indicating reversals",
      "enabled": true,
      "minConflictingSignals": 2,
      "conflictConfidence": 60,
      "weight": 0.1,
      "priority": 8,
      "logDetections": true
    },
    "postTPFilter": {
      "_comment": "FIX #7: Anti-FOMO filter after take-profit",
      "enabled": true,
      "consolidationMinutes": 10,
      "firstHalfMinutes": 5,
      "firstHalfRequired": 0.75,
      "secondHalfMinutes": 3,
      "secondHalfRequired": 0.70,
      "logDecisions": true
    },
    "shortEntryValidator": {
      "_comment": "FIX #8: Stricter SHORT entry requirements",
      "enabled": true,
      "minConfidenceShort": 0.75,
      "minConfidenceLong": 0.70,
      "requireMomentumConfirmation": true,
      "maxRsiForShort": 60,
      "logValidations": true
    },
    "entryCostValidator": {
      "_comment": "FIX #9: Ensures minimum analyzer consensus",
      "enabled": true,
      "minAnalyzersForShort": 2,
      "minAnalyzersForLong": 2,
      "maxSilentPercentShort": 40,
      "maxSilentPercentLong": 50,
      "logDecisions": true
    },
    "divergenceAnalyzer": {
      "enabled": true,
      "maxConfidence": 80,
      "hiddenDivergenceMode": "enabled",
      "hiddenBearishDivergenceConfidence": 65
    }
  },
  "entryThresholds": {
    "minTotalScore": 0.55
  },
  "services": {
    "websocket": {
      "pingIntervalMs": 20000,
      "reconnectDelayMs": 5000,
      "maxReconnectAttempts": 10,
      "authExpiresOffsetMs": 10000
    },
    "limitOrder": {
      "makerFeePercent": 0.01,
      "takerFeePercent": 0.06,
      "orderCheckIntervalMs": 200
    },
    "bot": {
      "periodicIntervalMs": 30000,
      "priceTolerance": 0.001
    }
  },
  "strategies": {
    "levelBased": {
      "enabled": true,
      "maxDistancePercent": 1.0,
      "minDistanceFloorPercent": 0.3,
      "minStrengthForNeutral": 0.25,
      "minTouchesRequired": 3,
      "minTouchesRequiredShort": 3,
      "minTouchesRequiredLong": 3,
      "minTouchesForStrong": 5,
      "requireTrendAlignment": true,
      "blockLongInDowntrend": true,
      "blockShortInUptrend": true,
      "stopLossAtrMultiplier": 1.5,
      "rrRatio": 1.5,
      "minConfidenceThreshold": 0.65,
      "levelClustering": {
        "clusterThresholdPercent": 0.3,
        "minTouchesForStrong": 5,
        "strengthBoost": 0.4,
        "baseConfidence": 0.7,
        "trendAlignmentBoost": 0.15,
        "maxLevelAgeCandles": 150,
        "candleIntervalMinutes": 1,
        "trendAlignedDistanceMultiplier": 1.5,
        "levelExhaustion": {
          "enabled": true,
          "penaltyPerBreakout": 0.15,
          "maxPenalty": 0.6,
          "breakoutThresholdPercent": 0.1,
          "lookbackCandles": 50
        },
        "breakoutMode": {
          "enabled": true,
          "minEmaGapPercent": 1.5,
          "rsiThresholdLong": 40,
          "rsiThresholdShort": 60,
          "minAtrPercent": 0.6,
          "confidenceBoost": 0.1,
          "useTrailingSL": true
        },
        "orderbookValidation": {
          "enabled": true,
          "minWallPercent": 5,
          "strengthBoost": 0.15,
          "maxDistancePercent": 0.3,
          "requireConfirmation": false
        },
        "sweepDetection": {
          "enabled": true,
          "minWickPercent": 0.1,
          "minRecoveryPercent": 50,
          "volumeSpikeMultiplier": 1.5,
          "lookbackCandles": 20,
          "maxSweepAgeCandles": 3,
          "trailSlOnSweep": true,
          "trailSlBufferPercent": 0.1
        },
        "trendFilters": {
          "minTrendGapPercent": 0.5,
          "downtrend": {
            "enabled": true,
            "rsiThreshold": 55
          },
          "uptrend": {
            "enabled": true,
            "rsiThreshold": 45
          }
        }
      },
      "distanceModifier": {
        "veryClosePercent": 0.5,
        "veryClosePenalty": 1.1,
        "farPercent": 1.2,
        "farPenalty": 0.9
      },
      "longEntry": {
        "enabled": true,
        "minConfidence": 70
      },
      "shortEntry": {
        "enabled": true,
        "minConfidence": 70
      },
      "entryConfirmation": {
        "enabled": true,
        "longBodyRatioMin": 0.2,
        "longWickRatioMax": 0.6,
        "shortBodyRatioMin": 0.2,
        "shortWickRatioMax": 0.6,
        "hammerWickRatio": 0.6,
        "shootingStarWickRatio": 0.6
      },
      "rsiFilters": {
        "enabled": true,
        "longMinThreshold": 30,
        "longMaxThreshold": 70,
        "shortMinThreshold": 30,
        "shortMaxThreshold": 70,
        "bypassOnStrongTrend": true,
        "strongTrendEmaGapPercent": 1.5
      },
      "emaFilters": {
        "enabled": true,
        "downtrend": {
          "rsiThreshold": 55,
          "emaDiffThreshold": 0.5
        }
      },
      "dynamicDistance": {
        "enabled": true,
        "atrMultiplier": 0.2,
        "absoluteMinPercent": 0.15
      },
      "trendExistenceFilter": {
        "enabled": true,
        "minEmaGapPercent": 0.5,
        "bypassOnStrongLevel": true,
        "strongLevelThreshold": 0.7
      },
      "levelSelection": {
        "tiebreakPreference": "NEAREST"
      },
      "timeWeightedStrength": {
        "enabled": true,
        "recentTouchBonusPercent": 20,
        "recentPeriodHours": 24
      },
      "volumeProfileIntegration": {
        "enabled": true,
        "addVahValLevels": true,
        "boostHvnMatch": true,
        "hvnMatchThresholdPercent": 0.3,
        "hvnStrengthBoost": 0.2,
        "vahValStrength": 0.7
      },
      "multiTimeframeConfirmation": {
        "enabled": true,
        "htfLevelConfirmation": {
          "enabled": true,
          "alignmentThresholdPercent": 0.3,
          "confidenceBoostPercent": 15
        },
        "trend2LevelConfirmation": {
          "enabled": true,
          "alignmentThresholdPercent": 0.4,
          "confidenceBoostPercent": 10
        },
        "contextTrendFilter": {
          "enabled": true,
          "minEmaGapPercent": 0.5
        }
      },
      "enhancedExit": {
        "riskRewardGate": {
          "enabled": true,
          "minRR": 1.5,
          "preferredRR": 2.0
        },
        "structureBasedTP": {
          "enabled": true,
          "mode": "LEVEL",
          "offsetPercent": 0.1,
          "fallbackPercent": 2.0,
          "useNextLevelAsTP1": true,
          "useSecondLevelAsTP2": false
        },
        "liquidityAwareSL": {
          "enabled": true,
          "extendBeyondLiquidity": true,
          "extensionPercent": 0.15,
          "useSwingPoints": true,
          "swingLookback": 20
        },
        "atrBasedTP": {
          "enabled": true,
          "tp1AtrMultiplier": 1.5,
          "tp2AtrMultiplier": 2.5,
          "tp3AtrMultiplier": 4.0,
          "minTPPercent": 0.5,
          "maxTPPercent": 5.0
        },
        "sessionBasedTP": {
          "enabled": true,
          "asianMultiplier": 0.8,
          "londonMultiplier": 1.0,
          "nyMultiplier": 1.0,
          "overlapMultiplier": 1.2
        },
        "dynamicBreakeven": {
          "enabled": true,
          "activationPercent": 1.0,
          "offsetPercent": 0.4
        },
        "timeDecayTP": {
          "enabled": true,
          "decayStartMinutes": 30,
          "decayRatePerHour": 0.5,
          "minTPPercent": 0.5
        },
        "adaptiveTrailing": {
          "enabled": true,
          "activationPercent": 1.5,
          "trailingDistancePercent": 0.3,
          "useATRDistance": false
        }
      },
      "mtfTPValidation": {
        "enabled": true,
        "htfTPValidation": {
          "enabled": true,
          "alignmentThresholdPercent": 0.3,
          "confidenceBoostPercent": 10
        },
        "trend2TPValidation": {
          "enabled": true,
          "alignmentThresholdPercent": 0.4,
          "confidenceBoostPercent": 5
        },
        "contextTPAdjustment": {
          "enabled": true,
          "minEmaGapPercent": 0.5,
          "alignedScaleFactor": 1.15,
          "opposedScaleFactor": 0.85
        },
        "scaling": {
          "noConfirm": 0.9,
          "htfConfirmed": 1.0,
          "bothConfirmed": 1.1
        }
      },
      "whaleWallTP": {
        "enabled": true,
        "minWallPercent": 5,
        "maxDistancePercent": 2.0,
        "minDistancePercent": 0.3,
        "tpTargeting": {
          "enabled": true,
          "alignmentThresholdPercent": 0.5,
          "scaleToWall": true,
          "minWallSizeForTP": 8
        },
        "slProtection": {
          "enabled": true,
          "moveSlBehindWall": true,
          "bufferPercent": 0.1,
          "minWallSizeForSL": 10
        },
        "qualityValidation": {
          "enabled": true,
          "rejectSpoofing": true,
          "boostIceberg": true,
          "icebergBoostFactor": 1.2,
          "minStrength": 0.3
        }
      }
    }
  },
  "indicators": {
    "rsiPeriod": 14,
    "rsiOversold": 30,
    "rsiOverbought": 70,
    "fastEmaPeriod": 20,
    "slowEmaPeriod": 50,
    "atrPeriod": 14,
    "zigzagDepth": 5
  },
  "atrFilter": {
    "enabled": true,
    "period": 14,
    "minimumATR": 0.05,
    "maximumATR": 5
  },
  "volatilityRegime": {
    "enabled": true,
    "thresholds": {
      "lowAtrPercent": 0.3,
      "highAtrPercent": 1.5
    },
    "sessionOverrides": {
      "enabled": true,
      "ASIAN": {
        "lowAtrPercent": 0.2,
        "highAtrPercent": 1.0
      },
      "LONDON": {
        "lowAtrPercent": 0.4,
        "highAtrPercent": 2.0
      },
      "NY": {
        "lowAtrPercent": 0.4,
        "highAtrPercent": 2.0
      },
      "OVERLAP": {
        "lowAtrPercent": 0.5,
        "highAtrPercent": 2.5
      }
    },
    "hysteresis": {
      "enabled": true,
      "bufferPercent": 0.1
    }
  },
  "strategicWeights": {
    "levelAnalysis": {
      "enabled": true,
      "_comment": "DISABLED: Duplicates LevelBasedStrategy"
    },
    "filters": {
      "btcCorrelation": { "enabled": false },
      "sessionFilter": { "enabled": false },
      "fundingRateFilter": { "enabled": false }
    }
  },
  "volumeProfile": {
    "enabled": true,
    "_comment": "DISABLED: Already integrated into LevelAnalyzer"
  },
  "dataSubscriptions": {
    "candles": {
      "enabled": true,
      "calculateIndicators": false
    },
    "orderbook": {
      "enabled": true,
      "updateIntervalMs": 1000
    },
    "ticks": {
      "enabled": true,
      "calculateDelta": true
    }
  },
  "logging": {
    "level": "DEBUG",
    "toFile": true,
    "toConsole": true
  },
  "dataCollection": {
    "enabled": true,
    "symbols": [
      "APEXUSDT",
      "SUIUSDT",
      "STRKUSDT"
    ],
    "timeframes": [
      "1m",
      "5m",
      "15m",
      "30m"
    ],
    "collectOrderbook": true,
    "orderbookInterval": 1,
    "collectTradeTicks": true,
    "database": {
      "path": "./data/market-data-multi.db",
      "compression": true
    },
    "websocket": {
      "reconnectDelay": 5000,
      "maxReconnectAttempts": 10
    }
  },
  "system": {
    "timeSyncIntervalMs": 30000,
    "timeSyncMaxFailures": 3
  },
  "entryConfirmation": {
    "long": {
      "enabled": true,
      "expirySeconds": 120,
      "tolerancePercent": 0.05
    },
    "short": {
      "enabled": true,
      "expirySeconds": 120,
      "tolerancePercent": 0.05
    }
  },
  "entryScanner": {
    "minEntryCandles": 50,
    "classicReversalBaseConfidence": 0.75,
    "liquiditySweepBaseConfidence": 0.8,
    "rsiLongConditionThreshold": 70,
    "rsiShortConditionThreshold": 30,
    "divergenceBoostDefault": 0.1,
    "divergencePenaltyFactor": 0.5,
    "chochBoostDefault": 0.1,
    "liquiditySweepBoostDefault": 0.15,
    "minConfidenceThreshold": 0.3,
    "confidenceClampMin": 0.3,
    "confidenceClampMax": 1
  },
  "analysisConfig": {
    "patternDetectors": {
      "wedge": {
        "baseConfidence": 65,
        "minPatternBars": 25,
        "maxPatternBars": 180,
        "recentLookback": 12,
        "exhaustionBonus": 15
      },
      "triangle": {
        "baseConfidence": 65,
        "minPatternBars": 30,
        "maxPatternBars": 200,
        "recentLookback": 12
      },
      "triplePattern": {
        "baseConfidence": 70,
        "peakTolerancePercent": 3.0,
        "minPatternBars": 20,
        "maxPatternBars": 150,
        "stopLossMultiplier": 0.15,
        "confidenceBonusFactor": 3.0,
        "confidencePerPoint": 5,
        "recentLookback": 10
      },
      "flag": {
        "baseConfidence": 65,
        "minConsolidationBars": 10,
        "maxConsolidationBars": 100,
        "minPoleHeightPercent": 2
      }
    },
    "marketStructure": {
      "chochAlignedBoost": 1.3,
      "chochAgainstPenalty": 0.5,
      "bosAlignedBoost": 1.1,
      "noModification": 1.0
    },
    "flatMarketDetector": {
      "hvnThreshold": 1.5,
      "lvnThreshold": 0.7,
      "maxEmaScore": 20,
      "maxAtrScore": 20,
      "maxRangeScore": 15,
      "maxSlopeScore": 15,
      "maxVolumeScore": 10
    },
    "liquidityDetector": {
      "fakeoutReversalPercent": 0.3,
      "recentTouchesWeight": 0.5,
      "oldTouchesWeight": 0.3
    }
  },
  "technicalThresholds": {
    "chartPatterns": {
      "minPointsHeadShoulders": 5,
      "minPointsDouble": 3,
      "minPointsTriple": 4,
      "minPointsTriangle": 6,
      "minPointsWedge": 6,
      "minPointsFlag": 6,
      "headTolerancePercent": 2,
      "shoulderTolerancePercent": 3,
      "necklineTolerancePercent": 2,
      "minPatternBars": 20,
      "maxPatternBars": 100
    }
  },
  "volumeProfile": {
    "enabled": true,
    "lookbackCandles": 200,
    "valueAreaPercent": 70,
    "priceTickSize": 0.001
  },
  "antiFlip": {
    "enabled": true,
    "cooldownCandles": 3,
    "cooldownMs": 300000,
    "requiredConfirmationCandles": 2,
    "overrideConfidenceThreshold": 85,
    "strongReversalRsiThreshold": 25
  },
  "strategy": {
    "type": "LEVEL_BASED",
    "emaFlatThreshold": 0.001,
    "emaDistanceThreshold": 5.5,
    "contextFilteringMode": "WEIGHT_BASED"
  },
  "marketHealth": {
    "enabled": true,
    "minWinRate": 0.40,
    "minProfitFactor": 1.2,
    "maxConsecutiveLosses": 5,
    "maxDrawdown": 0.15
  }
}